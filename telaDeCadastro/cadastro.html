<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="css/cadastro.css" type="text/css">
  <script src="proximo.js" type="text/javascript"></script>
  <title>Projeto Geóleo - Cadastre-se</title>
  <style>
  .menu{
    position: fixed;
    width: 100%;
    height: 100vw;
  }
  </style>
</head>
<body>

  <!-- <object type="text/html" data="../barrasDeNavegacao/barra-inicial.html" class="menu"></object> -->
  <nav class="navegador-superior">
    <a href="../index.html"><img src="../barrasDeNavegacao/barrasDeNavegacaoCSS/imagens/logo.png"></a>
    <ul>
      <li><a href="#" class="link-menu">entrar</a>
        <div id="login-box">
          <form name="login">
            <input type="text" name="nomeusuario" id="usuarioLogin" class="insert-text-login" placeholder="Usuário">
            <br><br>
            <input type="password" name="password" id="senhaLogin" class="insert-text-login" placeholder="Senha">
            <br><br>
            <!-- <a href="../telas/telaInicialLogada.html"> -->
            <div class="botoes-acao-menu" id="entrarLogin">entrar</div>
          <!-- </a> -->
          </form>
        </div>
      </li>
      <li><a href="#" class="link-menu">cadastre-se</a></li>
      <li><a href="#" class="link-menu">saiba +</a></li>
    </ul>
  </nav>

  <div class="conteudo">
  <div class="form-content">
    <h1>Cadastre-se</h1>
    <form method="get" name="cadastro">
      <input type="text" name="nome" id="nomeestabelecimento" class="insert-text" placeholder="Nome do estabelecimento">
      <input type="text" name="email" id="email" class="insert-text" placeholder="E-mail">
      <input type="text" name="nomeusuario" id="nomeusuario" class="insert-text" placeholder="Nome de usuário">
      <input type="password" name="senha" id="senha" class="insert-text" placeholder="Senha">
      <input type="password" name="senha2" id="senha2" class="insert-text" placeholder="Confirme a senha">
  </form>
  <div class="botoes-acao" id="continuar">continuar</div>
  </div>

  <div class="form-content-part2">
    <h1>Informe seus dados</h1>
    <form action="http://www.w3schools.com/html/action_page.php" method="get" name="cadastro">
      <input type="text" name="responsável" id="responsavel" class="insert-text" placeholder="Responsável">
      <input type="text" name="outro" id="outro" class="insert-text" placeholder="Outro Responsável">
      <input type="text" name="endereco" id="endereco" class="insert-text" placeholder="Endereço">
      <input type="text" name="telefone" id="telefone" class="insert-text" placeholder="Telefone">
      <input type="text" name="cnpj" id="cnpj" class="insert-text" placeholder="CNPJ">
      <input type="checkbox" name="termos" value="concordo"> <span>Estou de acordo com os <a href="#">termos de uso</a> do projeto Geóleo</span>
      <div class="lugarbotoes">
      <a href="../telas/telaInicialLogada.html"><div class="botoes-acao-pt2"  id="cadastrar">cadastrar</div></a>
      <div class="botoes-acao-voltar" id="voltar">voltar</div>
      </div>
  </form>
  </div>

  <div class="caixa-total">
    <div class="ala">
      <h1>Sobre nós</h1>
      Fundada em 2016, a EcoTech tem como objetivo unir tecnologia e design afim de
      tentar minimizar os impactos humanos no meio ambiente<br>
      <a href="#"><img src="../imagesRodape/facebook.png" style="width: 15px; margin-top: 10px; margin-right: 10px;"> facebook.com/EcoTech</a>
    </div>
    <div class="divisor"></div>
    <div class="ala">
      <h1>Contatos</h1>
      <a href="#"><img src="../imagesRodape/facebook.png" style="width: 15px; margin-top: 10px; margin-right: 10px;"> facebook.com/EcoTech</a><br>
      <a href="#"><img src="../imagesRodape/telefone.png" style="width: 15px; margin-top: 10px; margin-right: 10px;"> (88) 3414-2800</a><br>
      <a href="#"><img src="../imagesRodape/email.png" style="width: 15px; margin-top: 10px; margin-right: 10px;"> contato@EcoTech.com</a><br>
      <a href="#"><img src="../imagesRodape/site.png" style="width: 15px; margin-top: 10px; margin-right: 10px;"> www.EcoTech.com</a>
    </div>
    <div class="divisor"></div>
    <div class="ala">
      <h1>Newsletter</h1>
      Assine nossa newsletter para receber atualizações sobre nossos produtos e serviços por email
      <br><input type="text" class="news" placeholder="email">
      <input type="submit" class="enviarNews">
    </div>
    <div class="divisor"></div>
    <div class="ala">
      <h1>Apoio</h1>
      <img src="../imagesRodape/petrobras.gif" width="150px;">
      <img src="../imagesRodape/quixada.png" width="150px;" style="margin-top:10px">
    </div>
  </div>
  </div>



  <!-- <script src="proximo.js" type="text/javascript"></script> -->
  <script src="../barrasDeNavegacao/JS/login.js" type="text/javascript"></script>

  <script src="jquery-3.1.1.js"></script>
  <script>
    $("#cadastrar").click(function(){
      event.preventDefault();
      var nome = $("#nomeestabelecimento").val();
      var email = $("#email").val();
      var nomeUsuario = $("#nomeusuario").val();
      var senha = $("#senha").val();
      var senha2 = $("#senha2").val();
      var vcDoou = 0;
      var responsavel = $("#responsavel").val();
      var outro = $("#outro").val();
      var endereco = $("#endereco").val();
      var telefone = $("#telefone").val();
      var cnpj = $("#cnpj").val();

      if(nome != "" && email != "" && nomeUsuario != "" && senha != "" && senha2 != ""){
        if (senha != senha2) {
          $("#senha").val("");
          $("#senha2").val("");
          $(".form-content-part2").hide();
          return(alert("As senhas não correspondem"));
        }
        var conta = {"nomeEstabelecimento": nome, "email": email, "nomeUsuario": nomeUsuario, "senha": senha, "senha2": senha2, "vcDoou": vcDoou,
                    "responsavel": responsavel, "outro": outro, "endereco": endereco, "telefone": telefone, "cnpj": cnpj};
        $(".form-content").hide(100);
        $(".form-content-part2").show(100);
      }
      else {
        return(alert("Preencha todos os campos"))
      }


      $.ajax({
        type: "POST",
        url: "http://rest.learncode.academy/api/ecotech/geoleo2",
        data: JSON.stringify(conta),
        contentType: "application/json; charset=utf-8",
        success: function(data){
          $("#nomeestabelecimento").val("");
          $("#email").val("");
          $("#nomeusuario").val("");
          $("#senha").val("");
          $("#senha2").val("");
          $("#responsavel").val("");
          $("#outro").val("");
          $("#endereco").val("");
          $("#telefone").val("");
          $("#cnpj").val("");
          alert("Cadastro efetuado com sucesso");
          console.log(data);
        }
      })
    })

    $("#continuar").click(function(){
      $(".form-content").hide(150);
      $(".form-content-part2").show(150);
    })


    $("#voltar").click(function(){
      $(".form-content").show(100);
      $(".form-content-part2").hide(100);
    })

    //LOGIN
    $("#entrarLogin").click(function(){
      var usuarioLogin = $("#usuarioLogin").val();
      var senhaLogin = $("#senhaLogin").val();

      $.ajax({
        type: "GET",
        url: "http://rest.learncode.academy/api/ecotech/geoleo2",
        success: function(data){
          console.log("pegou");
          event.preventDefault();
          for(var i=0; i<data.length; i++){
            if (data[i].nomeUsuario == usuarioLogin) {
              if (data[i].senha == senhaLogin) {
                $("#usuarioLogin").val("");
                $("#senhaLogin").val("");
                window.location.href = "../telas/telaInicialLogada.html";
                localStorage.setItem("nome", data[i].nomeEstabelecimento);
                localStorage.setItem("email", data[i].email);
                localStorage.setItem("nomeUsuario", data[i].nomeUsuario);
                localStorage.setItem("senha", data[i].senha);
                localStorage.setItem("vcDoou", data[i].vcDoou);
                localStorage.setItem("id", data[i].id);
                localStorage.setItem("responsavel", data[i].responsavel);
                localStorage.setItem("outro", data[i].outro);
                localStorage.setItem("endereco", data[i].endereco);
                localStorage.setItem("telefone", data[i].telefone);
                localStorage.setItem("cnpj", data[i].cnpj);
                return(window.location.href);
              }
            }
          }
          alert("Usuário ou senha incorreto")
        }
      })
    })
  </script>
</body>
</html>
